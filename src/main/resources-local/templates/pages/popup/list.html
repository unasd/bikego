<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="../layout/default">

<!-- page CSS -->
<th:block layout:fragment="css">
</th:block>

<!-- page 스크립트 -->
<th:block layout:fragment="script">
    <script type="text/javascript">
        function goPage(page){
            $('[name="listForm"]').children('[name="page"]').val(page);
            $('[name="listForm"]').submit();
        }

        function goSearch(){
            $('[name="listForm"]').children('[name="page"]').val(1);
            $('[name="listForm"]').submit();
        }
        function goDetail(popupSeq) {
            location.href="/popup/detail.do?popupSeq="+popupSeq;
        }


        $(document).ready(function() {
            $('select').formSelect(); // select box 초기화
            $('#passwordModal').modal({
                dismissible: true, // Modal can be dismissed by clicking outside of the modal
                opacity: .5, // Opacity of modal background
                inDuration: 300, // Transition in duration
                outDuration: 200, // Transition out duration
                startingTop: '4%', // Starting top style attribute
                endingTop: '10%', // Ending top style attribute
                onCloseStart: function(e) {
                    console.info(e);
                    return false;
                }
            }); // modal 초기화

            $('.modal-trigger').on('click', function(e){
                $('#passwordAs').val('');
                $('#passwordModal').children('p').text($(this).children('span').text());
            });
        });
    </script>
</th:block>

<div layout:fragment="content" class="container full">
    <div class="col s12 right-align" style="margin: 2%;">
        <a th:href="@{/popup/post.do}" class="large material-icons" style="font-size: 30px; color: rgba(255, 255, 255, 1);">edit</a>
    </div>
    <ul class="collection popup-list">
        <li class="collection-item black no-border no-padding" th:each="popupList : ${popupList}" style="border-bottom: none;">
            <div class="row">
                <div class="col s12 m6 thumbnail" style="max-height: 300px; overflow: hidden;">
                    <img src="https://www.bianchi.com/wp-content/uploads/2020/05/BIANCHI-PARTICOLARI-02-09-19175182-634x452.jpg" alt="" style="width: 100%; height: auto;" />

<!--

                    C:\Users\sinna\IdeaProjects\upload\crud\2020\6\19\2e9ac6fd-d5c2-4d9c-915f-374cf641c07f1592531954084.PNG
                    <img style="max-height: 800px; width: 100%; overflow: hidden;" th:src="@{/attach/resizeImgView.do/} + ${popupList.attachId} + '/' + ${attachDto.snFileAttach}" />
-->


                </div>
                <div class="col s12 m6 desc">
                    <h6 class="teal-text" th:text="${#temporals.format(popupList.popupRegdt, 'yyyy-MM-dd')}" />
                    <h4 th:text="${popupList.popupTitle}" />
                    <div class="blue-grey-text lighten-5"  />
                    <!--#strings.length(str)   th:text="${popupList.contents}"-->
                    <p> 팝업게시기간 : <span th:text="${popupList.popupStartDt}"/> ~ <span th:text="${popupList.popupEndDt}"/> </p>
<!--
                    <p th:text="${#temporals.format(popupList.popupEndDt, 'yyyy-MM-dd')}"/>
-->
<!--
                    <p><th:block th:utext="${popupList.contents}"></th:block></p>
-->

                    <div align="right" style="padding-right: 5px;"><a class="waves-effect waves-light btn-small" th:onclick="|javascript:goDetail('${popupList.popupSeq}');|">more</a></div>



                </div>
            </div>
        </li>
    </ul>
    <div class="row" align="center">
        <form name="listForm" method="get" action="/popup/list">
            <input type="hidden" name="page" th:value="${pagingResult.page}"/>
            <input type="hidden" name="listSize" th:value="${pagingResult.listSize}"/>
            <input type="hidden" name="pageSize" th:value="${pagingResult.pageSize}"/>
            <input type="hidden" name="direction" th:value="${pagingResult.direction}"/>
            <input type="hidden" name="sortProp" th:value="${pagingResult.sortProp}"/>

            <div class="row">
                <div class="col s12 m8 offset-m2">
                    <div class="row">
                        <div class="input-field col s3">
                            <select name="searchType" class="white-text">
                                <option value="popupTitle" th:selected="(${searchDto.searchType} == 'popupTitle')">제목</option>
                                <option value="popupWriter" th:selected="(${searchDto.searchType} == 'popupWriter')">작성자</option>
                            </select>
                        </div>
                        <div class="input-field col s6" >
                            <input style="color: #fff3e0" id="searchKeyword" name="searchKeyword" type="text" class="validate" th:value="${searchDto.searchKeyword}"
                                    onkeypress="if( event.keyCode==13 ){goSearch();}">
                            <label for="searchKeyword">검색어</label>
                        </div>
                        <div class="input-field col s3 left-align">
                            <button class="btn waves-effect waves-light" type="button" id="searchBtn" onclick="javascript:goSearch();">검색</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <th:block th:if="${not #lists.isEmpty(popupList)}">
        <ul class="pagination">
            <th:block th:if="${pagingResult.hasPrevious}">
                <li class="waves-effect"><a th:onclick="|javascript:goPage('${pagingResult.page-1}');|"><i class="material-icons">chevron_left</i></a></li>
            </th:block>
            <th:block th:unless="${pagingResult.hasPrevious}">
                <li class="disabled"><a><i class="material-icons">chevron_left</i></a></li>
            </th:block>

            <li th:each="pageCount : ${#numbers.sequence(pagingResult.startPage, pagingResult.endPage)}" th:class="${pagingResult.page == pageCount ? 'active' : 'waves-effect'}">
                <th:block th:if="${pagingResult.page == pageCount}"><a th:text="${pageCount}"></a></th:block>
                <th:block th:unless="${pagingResult.page == pageCount}"><a th:onclick="|javascript:goPage('${pageCount}');|" th:text="${pageCount}"></a></th:block>
            </li>

            <th:block th:if="${pagingResult.hasNext}">
                <li class="waves-effect"><a th:onclick="|javascript:goPage('${pagingResult.page+1}');|"><i class="material-icons">chevron_right</i></a></li>
            </th:block>
            <th:block th:unless="${pagingResult.hasNext}">
                <li class="disabled"><a><i class="material-icons">chevron_right</i></a></li>
            </th:block>
        </ul>
    </th:block>

</div>
</html>
